from xml.etree.ElementTree import Element, SubElement, ElementTree
import xml.dom.minidom
import uuid  # å¼•å…¥uuidæ¨¡å¡Šï¼Œç”¨æ–¼ç”Ÿæˆæœ‰æ•ˆçš„UUID

# å‰µå»ºæ ¹å…ƒç´ ï¼Œè¨­ç½®å…¶ç‰ˆæœ¬ç‚º1.0
root = Element('plist', version='1.0')

# åœ¨æ ¹å…ƒç´ ä¸‹å‰µå»ºdictå…ƒç´ 
_dict = SubElement(root, 'dict')

# æ·»åŠ åŸºæœ¬çš„Payloadä¿¡æ¯
SubElement(_dict, 'key').text = 'PayloadDisplayName'
SubElement(_dict, 'string').text = 'ğŸ‡ºğŸ‡² ç¾å›½ 03'

SubElement(_dict, 'key').text = 'PayloadIdentifier'
SubElement(_dict, 'string').text = 'com.example.vpn'  # ä½¿ç”¨å”¯ä¸€çš„æ¨™è­˜ç¬¦

SubElement(_dict, 'key').text = 'PayloadType'
SubElement(_dict, 'string').text = 'Configuration'

# ç”Ÿæˆä¸€å€‹æœ‰æ•ˆçš„UUID
new_uuid = str(uuid.uuid4())

# ä½¿ç”¨ç”Ÿæˆçš„æœ‰æ•ˆUUID
SubElement(_dict, 'key').text = 'PayloadUUID'
SubElement(_dict, 'string').text = new_uuid

SubElement(_dict, 'key').text = 'PayloadVersion'
SubElement(_dict, 'integer').text = '1'

# æ·»åŠ VPNé…ç½®ä¿¡æ¯
SubElement(_dict, 'key').text = 'VPNType'
SubElement(_dict, 'string').text = 'IPSec'  # ä½¿ç”¨iOSæ”¯æŒçš„VPNé¡å‹

SubElement(_dict, 'key').text = 'ServerAddress'
SubElement(_dict, 'string').text = '2pwiyzakfjnmvikqu7la.wgetapi.com'

SubElement(_dict, 'key').text = 'ServerPort'
SubElement(_dict, 'integer').text = '4046'

SubElement(_dict, 'key').text = 'Password'
SubElement(_dict, 'string').text = 'da06745f-bc5b-3d1a-83e8-689d747deda1'

SubElement(_dict, 'key').text = 'SNI'
SubElement(_dict, 'string').text = '92zpkcdwze29gaqizktn.appletls.com'

SubElement(_dict, 'key').text = 'SkipCertVerify'
SubElement(_dict, 'true')  # æ­£ç¢ºçš„æ–¹å¼ä¾†è¨­ç½®å¸ƒçˆ¾å€¼

# å‰µå»ºElementTreeå°è±¡ä¸¦å¯«å…¥æ–‡ä»¶
tree = ElementTree(root)

# æ ¼å¼åŒ–è¼¸å‡ºXMLå­—ç¬¦ä¸²
xml_str = xml.dom.minidom.parseString(ElementTree.tostring(root)).toprettyxml(indent="   ")

# å°‡æ ¼å¼åŒ–çš„XMLå­—ç¬¦ä¸²ä¿å­˜åˆ°.mobileconfigæ–‡ä»¶ä¸­
with open("trojan_vpn_config.mobileconfig", "w") as f:
    f.write(xml_str)
